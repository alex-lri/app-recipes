<template>
    <div class="page" data-name="wishlist">
        <div class="navbar">
            <div class="navbar-bg"></div>
            <div class="navbar-inner sliding">
                <div class="title">My Wishlist</div>
            </div>
        </div>
        <div class="page-content">
            <div class="color-theme-black">
                <div class="container">
                    <h2 class="text-align-center">My Wishlist</h2>
                    <div>
                    <div class="block">
                        <button class="button button-fill" @click=${addToWishList}>Add Wish list</Button>
                    </div>
                        ${favoriteRecipes.value.map((recipe) => $h`
                        <div class="recipe-container" style="background-image: url(${recipe.thumbUrl});">
                            <div class="mask-img">
                            <i class="icon f7-icons if-not-md" id="hearthInWishList">suit_heart_fill</i>
                            <i class="icon material-icons if-md" id="hearthInWishList">suit_heart_fill</i>
                            <h2>${recipe.name}</h2>
                            <a class="recipe-btn" href="/recipe-details/${recipe.idMeal}/">Voir la recette</a>
                            </div>
                        </div>
                        `)}
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
<script>
    export default (props, {
        $store
    }) => {
        var randomRecipe = props.randomRecipe;
        var randomRecipeThumbUrl = randomRecipe.meals[0].strMealThumb
        var favoriteRecipes = $store.getters.favoriteRecipes;
        const randomRecipeUrl = "https://www.themealdb.com/api/json/v1/1/random.php";

        const addToWishList = () => {
            Framework7.request.get(randomRecipeUrl).then((res) => {
                randomRecipe = JSON.parse(res.data)
            })
            randomRecipeThumbUrl = randomRecipe.meals[0].strMealThumb
            favoriteRecipes = $store.getters.favoriteRecipes;
            console.log(randomRecipeThumbUrl)
            var li_class = document.getElementsByClassName("wishlist-item")[0].cloneNode(true);
            document.getElementsByClassName("wishlist-list")[0].appendChild(li_class);
            console.log(randomRecipeThumbUrl)
            $( "div li:last-child" ).css({ backgroundImage: url(randomRecipeThumbUrl) })
            //document.getElementsByClassName("wishlist-list")[0].lastChild.style.backgroundImage = "url("+randomRecipeThumbUrl+")"
            //document.querySelectorAll("li")[0].style.backgroundImage = "url("+randomRecipeThumbUrl+")"
        }
        return $render;
    }
</script>