<template>
  <div class="page" data-name="recipes">
    <div class="navbar">
      <div class="navbar-bg"></div>
      <div class="navbar-inner sliding">
        <div class="title">Recettes</div>
      </div>
    </div>
    <div class="page-content">
      <div class="text-align-center">
        <h2>Cat√©gories de recettes</h2>
      </div>
      <div class="list">
        <ul class="categories-list">
          ${categories.value.map((category) => $h`
          <li class="center-background-image category-item" style="background-image: url(${category.strCategoryThumb});"><a href="/recipes-by-category/${category.strCategory}/">${category.strCategory}</a></li>
          `)}
        </ul>
      </div>
    </div>
  </div>
</template>
<script>
    export default (props, {
        $store,
        $onBeforeMount
    }) => {
        const randomRecipe = props.randomRecipe.meals[0];
        const randomRecipeThumbUrl = randomRecipe.strMealThumb;
        const categories = $store.getters.categories;
        $onBeforeMount(() => {

            const recipesCategoriesUrl = "https://www.themealdb.com/api/json/v1/1/categories.php";
            
            Framework7.request.get(recipesCategoriesUrl).then((res) => {
                var recipesCategories = JSON.parse(res.data);
                for (let category of recipesCategories.categories) {
                    $store.dispatch('addCategory', category);
                }
            });
        });
        return $render;
    }
</script>
